# Интерфейс бронирований

## Мои бронирования (ReservationsPage)

### Описание

Страница отображает все бронирования текущего пользователя с возможностью отмены.

### Функциональность

- Список всех бронирований пользователя
- Информация о забронированном туре
- Статус бронирования
- Отмена бронирования

### Карточка бронирования

Каждая карточка содержит:

- Название тура (ссылка на детали)
- Агентство
- Город
- Даты тура
- Количество гостей
- Итоговая стоимость
- Примечания (если есть)
- Дата бронирования
- Статус (Подтверждено / Ожидает)

### API-запросы

**Получение бронирований:**
```
GET /reservations/my
Authorization: Bearer <token>
```

**Ответ:**
```json
[
  {
    "id": 1,
    "tour_id": 5,
    "user_id": 1,
    "guests": 2,
    "notes": "Нужен трансфер",
    "confirmed": false,
    "created_at": "2025-01-10T12:00:00Z",
    "tour": {
      "id": 5,
      "title": "Тур на Байкал",
      "agency": "Baikal Tours",
      "price": 75000,
      "city": "Иркутск",
      "start_date": "2025-07-15T00:00:00Z",
      "end_date": "2025-07-22T00:00:00Z"
    }
  }
]
```

---

## Создание бронирования

### Модальное окно

Бронирование создаётся через модальное окно на странице тура.

### Поля формы

| Поле | Тип | Обязательное | По умолчанию |
|------|-----|--------------|--------------|
| Количество гостей | number | Да | 1 |
| Примечания | textarea | Нет | - |

### Валидация

- Количество гостей ≥ 1

### API-запрос

```
POST /reservations/
Content-Type: application/json
Authorization: Bearer <token>

{
  "tour_id": 5,
  "guests": 2,
  "notes": "Нужен трансфер из аэропорта"
}
```

### Ответ

```json
{
  "id": 1,
  "tour_id": 5,
  "user_id": 1,
  "guests": 2,
  "notes": "Нужен трансфер из аэропорта",
  "confirmed": false,
  "created_at": "2025-01-10T12:00:00Z",
  "tour": {
    "id": 5,
    "title": "Тур на Байкал",
    ...
  }
}
```

---

## Отмена бронирования

### Процесс

1. Нажатие кнопки "Отменить"
2. Подтверждение в диалоговом окне
3. Отправка запроса на удаление
4. Обновление списка

### API-запрос

```
DELETE /reservations/{id}
Authorization: Bearer <token>
```

### Уведомления

| Действие | Сообщение |
|----------|-----------|
| Успешное создание | "Бронирование создано" |
| Успешная отмена | "Бронирование отменено" |
| Ошибка | "Не удалось выполнить операцию" |

---

## Статусы бронирования

| Статус | Badge | Описание |
|--------|-------|----------|
| Ожидает | `variant="secondary"` | Бронирование ожидает подтверждения |
| Подтверждено | `className="bg-green-500"` | Бронирование подтверждено |

### Компонент статуса

```tsx
const getStatusBadge = (reservation: Reservation) => {
  if (reservation.confirmed) {
    return (
      <Badge className="bg-green-500">
        <Check className="h-3 w-3 mr-1" />
        Подтверждено
      </Badge>
    );
  }
  return (
    <Badge variant="secondary">
      <X className="h-3 w-3 mr-1" />
      Ожидает
    </Badge>
  );
};
```

---

## Расчёт стоимости

Общая стоимость рассчитывается как:

```typescript
const totalPrice = tour.price * guests;
```

И отображается в карточке бронирования:

```tsx
<p className="text-lg font-bold">
  {formatPrice(reservation.tour.price * reservation.guests)}
</p>
```
