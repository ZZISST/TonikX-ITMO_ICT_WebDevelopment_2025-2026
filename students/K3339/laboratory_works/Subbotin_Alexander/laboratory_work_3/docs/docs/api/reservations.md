# API: Бронирования

Endpoints для управления бронированиями туров.

## Создание бронирования

### `POST /reservations/`

Создание нового бронирования тура.

**Требуется авторизация:** ✅

**Тело запроса:**

```json
{
  "tour_id": 1,
  "guests": 2,
  "notes": "Требуется детское кресло в автобусе"
}
```

**Параметры:**

| Поле | Тип | Обязательно | Описание |
|------|-----|-------------|----------|
| tour_id | integer | ✅ | ID тура для бронирования |
| guests | integer | ✅ | Количество гостей (> 0) |
| notes | string | ❌ | Дополнительные заметки |

**Успешный ответ (201 Created):**

```json
{
  "id": 1,
  "tour_id": 1,
  "user_id": 1,
  "guests": 2,
  "notes": "Требуется детское кресло в автобусе",
  "created_at": "2025-01-06T12:00:00",
  "confirmed": false,
  "tour": {
    "id": 1,
    "title": "Тур в Париж",
    "agency": "Dream Tours",
    "description": "Незабываемое путешествие",
    "start_date": "2025-06-01",
    "end_date": "2025-06-07",
    "price": "1500.00",
    "city": "Париж",
    "payment_terms": "Оплата 50% при бронировании"
  }
}
```

**Ошибки:**

- `401 Unauthorized` - требуется авторизация
- `404 Not Found` - тур не найден
- `422 Unprocessable Entity` - невалидные данные

---

## Мои бронирования

### `GET /reservations/my`

Получение всех бронирований текущего пользователя.

**Требуется авторизация:** ✅

**Query параметры:**

| Параметр | Тип | По умолчанию | Описание |
|----------|-----|--------------|----------|
| limit | integer | 100 | Количество записей на странице |
| offset | integer | 0 | Смещение для пагинации |

**Успешный ответ (200 OK):**

```json
[
  {
    "id": 1,
    "tour_id": 1,
    "user_id": 1,
    "guests": 2,
    "notes": "Требуется детское кресло",
    "created_at": "2025-01-06T12:00:00",
    "confirmed": false,
    "tour": {
      "id": 1,
      "title": "Тур в Париж",
      "city": "Париж",
      "start_date": "2025-06-01",
      "end_date": "2025-06-07",
      "price": "1500.00"
    }
  }
]
```

---

## Получение бронирования

### `GET /reservations/{id}`

Получение информации о конкретном бронировании.

**Требуется авторизация:** ✅

**Path параметры:**

| Параметр | Тип | Описание |
|----------|-----|----------|
| id | integer | ID бронирования |

**Успешный ответ (200 OK):**

Аналогичен ответу при создании.

**Ошибки:**

- `401 Unauthorized` - требуется авторизация
- `403 Forbidden` - бронирование принадлежит другому пользователю
- `404 Not Found` - бронирование не найдено

---

## Обновление бронирования

### `PUT /reservations/{id}`

Обновление существующего бронирования.

**Требуется авторизация:** ✅

**Path параметры:**

| Параметр | Тип | Описание |
|----------|-----|----------|
| id | integer | ID бронирования |

**Тело запроса (все поля опциональны):**

```json
{
  "guests": 3,
  "notes": "Обновлённые заметки",
  "confirmed": true
}
```

**Успешный ответ (200 OK):**

Возвращает обновлённое бронирование с информацией о туре.

**Ошибки:**

- `401 Unauthorized` - требуется авторизация
- `403 Forbidden` - можно обновлять только свои бронирования
- `404 Not Found` - бронирование не найдено

---

## Удаление бронирования

### `DELETE /reservations/{id}`

Отмена бронирования.

**Требуется авторизация:** ✅

**Path параметры:**

| Параметр | Тип | Описание |
|----------|-----|----------|
| id | integer | ID бронирования |

**Успешный ответ (204 No Content):**

Тело ответа пустое.

**Ошибки:**

- `401 Unauthorized` - требуется авторизация
- `403 Forbidden` - можно удалять только свои бронирования
- `404 Not Found` - бронирование не найдено

---

## Полный пример

```python
import requests

BASE_URL = "http://localhost:8000"
token = "YOUR_ACCESS_TOKEN"
headers = {"Authorization": f"Bearer {token}"}

# 1. Создание бронирования
reservation = requests.post(
    f"{BASE_URL}/reservations/",
    headers=headers,
    json={
        "tour_id": 1,
        "guests": 2,
        "notes": "Нужна вегетарианская еда"
    }
).json()
reservation_id = reservation["id"]
print(f"Бронирование создано: {reservation_id}")

# 2. Получение своих бронирований
my_reservations = requests.get(
    f"{BASE_URL}/reservations/my",
    headers=headers
).json()
print(f"Всего бронирований: {len(my_reservations)}")

# 3. Обновление бронирования
requests.put(
    f"{BASE_URL}/reservations/{reservation_id}",
    headers=headers,
    json={"guests": 3, "confirmed": True}
)
print("Бронирование обновлено")

# 4. Удаление бронирования
requests.delete(
    f"{BASE_URL}/reservations/{reservation_id}",
    headers=headers
)
print("Бронирование отменено")
```
